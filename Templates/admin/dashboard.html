{% extends "base.html" %}

{% block title %}Quản trị - Dashboard{% endblock %}

{% block extra_css %}
<style>
    .admin-header {
        background: #2c3e50;
        color: white;
        padding: 1.5rem;
        margin: -2rem -1rem 2rem;
        border-radius: 4px;
    }
    
    .admin-header h1 {
        font-size: 2rem;
        font-weight: 700;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: 4px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        border-left: 4px solid;
    }
    
    .stat-card.primary {
        border-color: #3498db;
    }
    
    .stat-card.success {
        border-color: #27ae60;
    }
    
    .stat-card.warning {
        border-color: #f39c12;
    }
    
    .stat-card.danger {
        border-color: #e74c3c;
    }
    
    .stat-label {
        font-size: 0.9rem;
        color: #7f8c8d;
        margin-bottom: 0.5rem;
    }
    
    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: #2c3e50;
    }
    
    .section {
        background: white;
        padding: 1.5rem;
        border-radius: 4px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        margin-bottom: 2rem;
    }
    
    .section-title {
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: #2c3e50;
        border-bottom: 2px solid #ecf0f1;
        padding-bottom: 0.5rem;
    }
    
    .table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .table th {
        background: #ecf0f1;
        padding: 0.75rem;
        text-align: left;
        font-weight: 600;
        color: #2c3e50;
    }
    
    .table td {
        padding: 0.75rem;
        border-bottom: 1px solid #ecf0f1;
    }
    
    .table tr:hover {
        background: #f8f9fa;
    }
    
    .badge {
        padding: 0.3rem 0.6rem;
        border-radius: 3px;
        font-size: 0.85rem;
        font-weight: 600;
    }
    
    .badge-warning {
        background: #fff3cd;
        color: #856404;
    }
    
    .badge-danger {
        background: #f8d7da;
        color: #721c24;
    }
</style>
{% endblock %}

{% block content %}
<div class="admin-header">
    <h1>Quản trị hệ thống</h1>
    <p>Tổng quan và thống kê</p>
</div>

<div class="stats-grid">
    <div class="stat-card primary">
        <div class="stat-label">Tổng sản phẩm</div>
        <div class="stat-value">{{ stats.total_products }}</div>
    </div>
    
    <div class="stat-card success">
        <div class="stat-label">Tổng đơn hàng</div>
        <div class="stat-value">{{ stats.total_orders }}</div>
    </div>
    
    <div class="stat-card warning">
        <div class="stat-label">Tổng khách hàng</div>
        <div class="stat-value">{{ stats.total_users }}</div>
    </div>
    
    <div class="stat-card danger">
        <div class="stat-label">Doanh thu</div>
        <div class="stat-value">{{ "{:,.0f}".format(stats.total_revenue) }}đ</div>
    </div>
</div>

<div class="section">
    <h2 class="section-title">Sản phẩm sắp hết hàng</h2>
    {% if stats.low_stock %}
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Tên sản phẩm</th>
                    <th>Tồn kho</th>
                    <th>Trạng thái</th>
                </tr>
            </thead>
            <tbody>
                {% for product in stats.low_stock %}
                    <tr>
                        <td>{{ product.id }}</td>
                        <td>{{ product.name }}</td>
                        <td>{{ product.stock }}</td>
                        <td>
                            {% if product.stock <= 2 %}
                                <span class="badge badge-danger">Rất thấp</span>
                            {% else %}
                                <span class="badge badge-warning">Thấp</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p style="color: #7f8c8d;">Tất cả sản phẩm còn hàng đầy đủ</p>
    {% endif %}
</div>

<div class="section">
    <h2 class="section-title">Đơn hàng gần đây</h2>
    {% if stats.recent_orders %}
        <table class="table">
            <thead>
                <tr>
                    <th>Mã ĐH</th>
                    <th>Sản phẩm</th>
                    <th>Số lượng</th>
                    <th>Tổng tiền</th>
                    <th>Trạng thái</th>
                    <th>Ngày đặt</th>
                </tr>
            </thead>
            <tbody>
                {% for order in stats.recent_orders %}
                    <tr>
                        <td>#{{ order.id }}</td>
                        <td>{{ order.product_name }}</td>
                        <td>{{ order.quantity }}</td>
                        <td>{{ "{:,.0f}".format(order.total_price) }}đ</td>
                        <td>{{ order.status }}</td>
                        <td>{{ order.created_at[:10] }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p style="color: #7f8c8d;">Chưa có đơn hàng nào</p>
    {% endif %}
</div>
{% endblock %}